## 1、<span style="color:brown">优先级说明：</span>

**1.1、中断系统结构：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/External_Interrupt07.png" alt="image-20250912183733783" style="zoom:50%;" />

如图为默认优先级：`INT0`最高，`INT3`最低。

**1.2、PH与IPH寄存器：**

**`STC89C51RC/RD+`系列单片机**，各优先级控制寄存器的格式如下：

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/External_Interrupt08.png" alt="image-20250912190135949" style="zoom:67%;" />

```cmake
//IP寄存器可以位操作，IPH只能寄存器操作
//优先级也可以不设置，默认的中断优先级就是0, 因为复位之后IPH和IP寄存器默认值就是0
PX0 = 1;
IPH = 0x01;
```



## 2、<span style="color:brown">优先级调整：</span>

**2.1、调整方式：**

以`INT0`为例，调整优先级方式为：

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/External_Interrupt09.png" alt="image-20250912185813669" style="zoom:80%;" />

**2.2、功能实现：**

> 优先级调整，需要在**EA使能前操作** 

```c
void delay_ms(unsigned int xms); // 延时函数
void exit0() interrupt 0; // 中断任务1
void exit2() interrupt 6; // 中断任务2
void main()
{
    // 初始化INT0、INT1
    IT2 = 1; // 设置中断2触发条件为下降沿
    EX2 = 1; // 运行中断2经过
	IT0 = 1; // 设置中断0触发条件为下降沿
	EX0 = 1; // 运行中断0经过
	// 设置INT0优先级为0, INT2优先级为3	
	IPH = 0x40;
	PX0 = 0;
	PX2 = 1;
	// 使能中断
	EA = 1;
    while(1)
    {
         delay_ms(20000); // 主任务
    }                
}

```

因为**`IPH`寄存器不可能位寻址**，只能**寄存器整体操作**，因此要实现上述优先级，需要`PX0H = 0`、`PX2H = 1`.

**`IPH`寄存器**复位值为`0000 0000B`，因此赋值`0x40 = 0100 0000B`。