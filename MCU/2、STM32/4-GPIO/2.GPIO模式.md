## 1、<span style="color:brown">GPIO输入：</span>

> **TTL肖特基触发器**：信号经过触发器后，**模拟信号**转化为**0和1的数字信号**。

**1.1、浮空输入：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO05.png" alt="image-20251113182616991" style="zoom:40%;" />

<u>在<span style="color:blue">模拟输入</span></u>，设置<u>浮空模式</u>，`IO`会变成<span style="color:green">**高阻态**</span>，**IO电平**由<span style="color:red">外部电平</span>决定。

**1.2、上拉输入：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO06.png" alt="image-20251113182730532" style="zoom:40%;" />

设置<u>上拉模式</u>，在**无外部信号输入**时，**IO电平**是`HIGH_LEVEL`。

**1.3、下拉输入：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO07.png" alt="image-20251113182916412" style="zoom:40%;" />

设置<u>下拉模式</u>，在**无外部信号输入**时，**IO电平**是`LOW_LEVEL`。

**1.4、模拟输入：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO08.png" alt="image-20251113182840552" style="zoom:40%;" />

<u>模拟输入</u>一般是用来**ADC读取和转换**。



## 2、<span style="color:brown">GPIO输出：</span>

**2.1、开漏输出：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO09.png" alt="image-20251113185351628" style="zoom:40%;" />

| <u>输出寄存器</u>为`0`，<u>输出控制电路</u>转为`1` |      <u>输出寄存器</u>为`1`，<u>输出控制电路</u>转为`0`      |
| :------------------------------------------------: | :----------------------------------------------------------: |
|  `N-MOS`导通，引脚接`VSS`，`IO`电平为`LOW_LEVEL`   | `N-MOS`截止，`IO`电平为<span style="color:green">**高阻态**</span>，由<span style="color:red">外部上拉电阻</span>决定 |

**2.2、复用开漏输出：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO10.png" alt="image-20251113192353593" style="zoom:40%;" />

**复用开漏输出**和**开漏输出**的区别在于**信号来源**，复用的来源**不是通过输出数据寄存器写的**，而是由<span style="color:blue">复用功能的外设</span>决定的。

**2.3、推挽输出：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO11.png" alt="image-20251113192638881" style="zoom:40%;" />

|      <u>输出寄存器</u>为`0`，<u>输出控制电路</u>转为`1`      |       <u>输出寄存器</u>为1，<u>输出控制电路</u>转为`0`       |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| `N-MOS`打开，`P-MOS`关闭，引脚接`VSS`，`IO`电平为`LOW_LEVEL` | `N-MOS`关闭，`P-MOS`打开，引脚接`VDD`，IO电平为<u><span style="color:red">`VDD`</span>（<span style="color:red">`STM32`中，`VDD=3.3 V`</span>）</u> |

**2.4、复用推挽输出：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_GPIO12.png" alt="image-20251113193617658" style="zoom:40%;" />

**复用推挽输出**和**推挽输出**的区别在于**信号来源**，其信号来源是由<span style="color:blue">复用功能相关的通信通道</span>来控制。



## 3、<span style="color:brown">模式选择：</span>

**3.1、Input模式：**✅

根据**板卡原理图**，针对以下情况进行选择：

1. 如果外部有**上拉电阻 \ 下拉电阻**，选择<u>浮空输入</u>；
2.  如果外部没有上下拉的，**内部就选择上、下拉电阻**：
   - 外部有效信号是`High_ACTIVE`，`IO`默认电平就应该为`LOW_LEVEL`，选择<u>下拉输入</u>；
   - 外部有效信号是`LOW_ACTIVE`，`IO`默认电平就应该为`HIGH_LEVEL`，选择<u>上拉输入</u>；

**3.2、Output模式：**

**推挽**驱动**常规设备**，**开漏**实现**兼容通信**：

| 功能类型                      | 模式选择 | 是否上拉/下拉                           | 说明             |
| ----------------------------- | -------- | --------------------------------------- | ---------------- |
| LED、蜂鸣器、继电器等普通输出 | 推挽     | 无                                      | 常用基础输出模式 |
| 与 5V 电平设备通信            | 开漏     | <span style="color:red">外部上拉</span> | 实现电平兼容     |

**复用推挽**服务**高速外设**，**复用开漏**支持**总线协议**：

| 功能类型               | 模式选择 | 是否上拉/下拉                           | 说明                                         |
| ---------------------- | -------- | --------------------------------------- | -------------------------------------------- |
| `UART`（`TX`、`RX`）   | 复用推挽 | 无                                      | 默认**复用推挽**                             |
| `SPI`、`MOSI`、`NSS`   | 复用推挽 | 无                                      | 通信速度高，需要稳定驱动                     |
| `I2C` （`SCL`、`SDA`） | 复用开漏 | <span style="color:red">外部上拉</span> | <span style="color:red">`I2C`协议要求</span> |

 