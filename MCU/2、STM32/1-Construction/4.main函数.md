## 1、<span style="color:brown">PC 与 int main()：</span>

在 **操作系统环境（Windows / Linux）** 下：

| 语言标准     | main 的返回值作用            |
| ------------ | ---------------------------- |
| ✅ C 语言标准 | main 必须返回 int            |
| ✅ 返回值含义 | 程序执行结果 → 返回给`OS`    |
| ✅ 示例       | `return 0;` 代表**正常退出** |

📌 在 PC 中，`main()` **一定会结束**，程序运行完成后返回到操作系统。



## 2、<span style="color:brown">MCU 与 void main()：</span>

`MCU`编程中，**main函数**使用`return_value_type = void`，原因如下：

1. **程序不会结束**：`main()` 的设计目标是**永远执行**；
2. **返回值无意义**：<span style="color:brown">没有操作系统</span>；

并采用的工作模式是： “**初始化 → main() + while(1) ↔ 外设中断打断执行**” ！



## 3、<span style="color:brown">main()结束：</span>

📌 结论：**MCU程序不会停止，而是自动重新执行 main() 或复位！**

这是因为<u>`MCU`会执行 **启动代码（startup code）**</u>，当**检测到 `main()` 返回**时，它会：

| MCU类型     | main结束后的行为           |
| ----------- | -------------------------- |
| 8051 / C51  | 重新跳回 main（循环执行）  |
| STM32 / ARM | CPU 触发 HardFault / Reset |

✅ `C51`中，删除 `while(1)` ，执行`LED`闪烁的代码？
✅ 现象：`LED`一直闪烁
✅ 原因：**重新跳回 main** + <span style="color:red">**逻辑可重复执行**且**无状态依赖**</span> 



## 4、<span style="color:brown">启动文件：</span>

`C51`的启动文件 `STARTUP.A51` 中有：

```
?C_STARTUP:
    ljmp  _main   ; 跳转到 C 的 main 函数
?C_EXIT:
    ljmp  _main   ; main 结束后重新跳回 main
```

📌 证明：**MCU 不允许 main() 退出，强制回到 main！**

这种机制**只是防止程序结束跑飞**，**不是循环机制**，因此<span style="color:red">不能完全替代**while(1)**</span>！

