## 1、<span style="color:brown">机械按键：</span>

**1.1、原理图：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/STM32_KEY01.png" alt="image-20251116164136541" style="zoom:50%;" />

KEY的电平情况：

| `KEY`未按下，电平为：`HIGH_LEVEL` | 按下`KEY`，电平为：`LOW_LEVEL` |
| --------------------------------- | ------------------------------ |

**1.2、按键消抖：**

**按下** / **松开**`Button`时，<u>接触的金属片</u>会因为**<u>弹性、震动等原因</u>，出现多个快速的电气跳变**，这种跳变叫做**抖动**。

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/Button03.png" alt="image-20250911153538817" style="zoom:40%;" />

当`Button`按下时，设置`delay = 5~10 ms`，目的是：**等待按键信号稳定下来**，再去<u>检查`KEY`的**电平高低**</u>。

**1.3、读取GPIO输入电平：**

````c
GPIO_PinState HAL_GPIO_ReadPin(GPIO_TypeDef *GPIOx, uint16_t GPIO_Pin);
````

**1.4、示例代码：**

````c
if(HAL_GPIO_ReadPin (GPIOC, GPIO_PIN_3) == 0) {
	HAL_Delay(10);
    if(HAL_GPIO_ReadPin (GPIOC, GPIO_PIN_3) == 0){
        // running = ~running;
        HAL_GPIO_TogglePin (GPIOA, GPIO_PIN_6);
        while(HAL_GPIO_ReadPin (GPIOC, GPIO_PIN_3) == 0);
    }
}
// if(running) {
//     HAL_GPIO_WritePin(GPIOA, GPIO_PIN_6, GPIO_PIN_RESET);
// } else {
//     HAL_GPIO_WritePin(GPIOA, GPIO_PIN_6, GPIO_PIN_SET);	}
````



## 2、<span style="color:brown">触摸按键：</span>

**2.1、原理图：**

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/Button04.png" alt="image-20250911160224829" style="zoom:40%;" />

QC有效电平和默认电平，由触控芯片`PT2041AT6`的`TOG`、`AHLB`决定。

**2.2、触控芯片：**

> `PT2041AT6`，是一种**单通道触摸检测**芯片

在[立创商城](https://www.szlcsc.com/?c=Q2&msclkid=85859f04a7d610fa116ff7c6258add7d&lcsc_vid=ElhZUQVWQQAIUABURANWBgJQFVhcUwEHRlRfX1NQE1kxVlNTQFRZUFxURVVcVzsOAxUeFF5JWAIASQYPGQZABAsLWA%3D%3D)，查找**`PT2041AT6`芯片**的`datasheet`：

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/Button05.png" alt="image-20250911160627739" style="zoom: 50%;" />

根据原理图，`QC`的**特性**：

- <u>同步模式、`CMOS`<span style="color:red">低电平有效</span></u>；
- <span style="color:red">默认电平为`HIGH_LEVEL`，按下`Touch Button`，电平变为`LOW_LEVEL`</span>；

**2.3、工程代码：**

```c
if(HAL_GPIO_ReadPin (GPIOC, GPIO_PIN_0 ) == 0) {
	HAL_Delay(10);
    if(HAL_GPIO_ReadPin (GPIOC, GPIO_PIN_0 ) == 0){
        HAL_GPIO_TogglePin (GPIOA, GPIO_PIN_6);
        while(HAL_GPIO_ReadPin (GPIOC, GPIO_PIN_0 ) == 0);
    }
}
```

