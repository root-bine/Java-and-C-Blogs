## 1、<span style="color:brown">串口介绍：</span>

**1.1、定义及作用：**

`UART` (`Universal Asynchronous Receiver Transmitter`，**通用异步收发器**) ，可实现单片机的串口通信。

串口具备<span style="color:red">**低成本**、**易操作**、**通信线路简单**</span>的特点，可实现**<u>两个设备的互相通信</u>**。

**1.2、通信分类：**

<span style="color:green"><u>串行通信</u>（推荐）</span>：使用**一条数据线**，将数据**一位一位地依次传输**，每一位数据占据**一个固定的时间长度**。

适用于<u>`PC`与`PC`、`PC`与`peripheral`之间</u>的**远距离通信**，<span style="color:red">先传输`low_bit`再传输`high_bit`</span>：

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/UART01.png" alt="image-20251007105013718" style="zoom: 67%;" />

<span style="color:green"><u>并行通信</u></span>：将**数据字节的各位**用<span style="color:red">多条数据线同时进行传送</span>，通常是`8 bit`，`16 bit`，`32 bit`等数据一起传输。

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/UART02.png" alt="image-20251007105329751" style="zoom: 67%;" />

|   对比   |          串行通信          |              并行通信              |
| :------: | :------------------------: | :--------------------------------: |
| **优点** | 传输线少，长距离传送成本低 |        控制简单，传输速度快        |
| **缺点** |      数据传输较为复杂      | 长距离传送成本高，**抗干扰能力差** |



## 2、<span style="color:brown">通信与电平：</span>

**2.1、传输方式：**

|                   分类                    |                             描述                             |
| :---------------------------------------: | :----------------------------------------------------------: |
|                 单工通信                  |                    数据只能**单方向传输**                    |
|                半双工通信                 | 通信双方**交替进行双向数据传输**，但两个方向的传输**不能同时进行** |
| <span style="color:red">全双工通信</span> |                  通信双方**可同时收发数据**                  |

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/UART03.png" alt="image-20251007110526644" style="zoom: 50%;" />

`80C51`单片机的**串行口**是<span style="color:red">**全双工**</span>传输方式，参考`datasheet`：<span style="color:red">`SCON = 0x50`</span>！！！

**2.2、电平标准：**

|                   分类                    |                       描述                       |
| :---------------------------------------: | :----------------------------------------------: |
| TTL电平（`Transistor transistor logic` ） |         `+3V ~ +5V`表示`1`， `0V`表示`0`         |
|                RS232 电平                 |    `-3V ~ -15V`表示`1`， `+3V ~ +15V`表示`0`     |
|        RS485 电平（**差分信号**）         | 两线压差`+2V ~ +6V`表示`1`， `-2V ~ -6V` 表示`0` |



## 3、<span style="color:brown">数据帧组成：</span>

**3.1、数据结构：**

**完整的串行数据**，即<span style="color:red">**数据帧**（`data frame`）</span>，其结构：

<img src="https://raw.githubusercontent.com/root-bine/image/main/Typora-image/UART04.png" alt="image-20251007121225780" style="zoom: 50%;" />

空闲位**不是串口报文的数据**，是发送完一组报文后，**总线会自动将电平拉高**，产生`1 bit`逻辑`1`的**空闲位**。

**3.2、串口波特率：**

| 特点             | <span style="color:red">波特率越高，传输速度越快</span>      |
| ---------------- | ------------------------------------------------------------ |
| **波特率值**     | `300 / 1200 / 2400 / 9600 / 19200 / 38400 / 115200 / 230400`等 |
| **串口通信速率** | 单位时间内，传输二进制的位数                                 |
|                  | 波特率为`9600`，指`1 s`内传输`9600 bit`，则**传输一位**需要`1/9600 = 104.17 us` |

**3.3、MSB与LSB：**

| 缩写    | 全称                    | 中文名     | 含义                             |
| ------- | ----------------------- | ---------- | -------------------------------- |
| **MSB** | `Most Significant Bit`  | 最高有效位 | 在二进制数中，**权值最大的一位** |
| **LSB** | `Least Significant Bit` | 最低有效位 | 在二进制数中，**权值最小的一位** |

`0x14`在**逻辑上的权值排序**，如下：

```c
bit7 bit6 bit5 bit4 bit3 bit2 bit1 bit0
 0    0    0    1    0    1    0    0
MSB                                LSB
```

在**逻辑分析仪的波形图**中，展现形式有两种模式：

- <span style="color:red">MSB-first（高位先传）</span>：

  ```c
  传输顺序（时间从左到右）:
    ↑
  bit7 → bit6 → bit5 → bit4 → bit3 → bit2 → bit1 → bit0
    0     0     0     1     0     1     0     0
  ```

- <span style="color:red">LSB-first（低位先传）</span>：

  ```c
  传输顺序（时间从左到右）:
    ↑
  bit0 → bit1 → bit2 → bit3 → bit4 → bit5 → bit6 → bit7
    0     0     1     0     1     0     0     0
  ```

**3.4、串口校验位：**

|   校验方式   |   英文缩写    |                        校验位规则说明                        |
| :----------: | :-----------: | :----------------------------------------------------------: |
|  **无校验**  | **N (None)**  |                         不使用校验位                         |
|  **奇校验**  |  **O (Odd)**  | 若`date`中`1`的个数为奇数，则校验位 = 0；若为偶数，则校验位 = 1 |
|  **偶校验**  | **E (Even)**  | 若`date`中`1`的个数为偶数，则校验位 = 0；若为奇数，则校验位 = 1 |
| **标记校验** | **M (Mark)**  |                       校验位始终为 `1`                       |
| **空格校验** | **S (Space)** |                       校验位始终为 `0`                       |
